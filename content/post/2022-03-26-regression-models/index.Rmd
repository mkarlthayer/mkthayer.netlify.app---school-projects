---
title: Regression Models
author: ''
date: '2022-03-26'
slug: regression-models
categories: []
tags: []
---
## The model predicts the price to be $2844.49 which makes the price of $3100 slightly high, but not a rip off (work below)

#Call Libraries
```{r}
library(tidyverse)
library(readxl)
library(ISLR)
library(boot)
```

#Get Data and transform as necessary (make Wholesaler a factor)
```{r}
df <- read_excel("data/Professor_Proposes_Data.xlsx")
df$Wholesaler <- as.factor(df$Wholesaler)
```

```{r}
## Set Seed: To reproduce the sampling for train - test split
set.seed(1)
head(df)
dim(df)
## Create an index to randomly sample 50% records for data set df
train <- sample(440,220)
head(train)
```


# Exploratory Data Analysis
```{r}
df %>%
  ggplot(aes(Price)) +
  geom_histogram()
df %>%
  ggplot(aes(Carat)) +
  geom_histogram()
summary(Price) 
```
Both Price And Carats have a bimodal distributions that can be explained by the Wholesaler
```{r}
df %>%
  ggplot(aes(x=Carat,y=Price, color=Wholesaler)) +
  geom_point()
```
```{r}
df1 <- df %>%
  filter(Wholesaler == 3)

max(df1$Carat)
#The largest Carat used by the the third Wholesaler is just 0.3, since the professor wants a 0.9 Carat diamond, its better to focus on data from the 1st and 2nd wholesaler wehere he will have to buy from
```
```{r}
df23 <- df %>%
  filter(Wholesaler == 2 | Wholesaler == 1)
# Data set only looking at the 1st and second wholesaler
# dimensions on new df
dim(df23)

df23 %>%
  ggplot(aes(x=Carat,y=Price, color=Wholesaler)) +
  geom_point()
```
```{r}
attach(df)
#attach data frame
```

```{r}
table(Certification)

# Split into established and small labs
df[Certification == "GIA", "Certification"] <- "GIA/AGS"
df[Certification == "AGS", "Certification"] <- "GIA/AGS"
df[Certification == "DOW", "Certification"] <- "Rest"
df[Certification == "IGI", "Certification"] <- "Rest"
df[Certification == "EGL", "Certification"] <- "Rest"

table(df$Certification)
```
```{r}
table(Colour)

df[Colour == "D", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "F", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "E", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "G", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "H", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "I", "Colour"] <- "Colorless/Near Colorless"
df[Colour == "J", "Colour"] <- "Faint to Very Light Yellow"
df[Colour == "K", "Colour"] <- "Faint to Very Light Yellow"
df[Colour == "L", "Colour"] <- "Faint to Very Light Yellow"

table(df$Colour)
```
```{r}
table(Cut)
# Even representation of data
```
```{r}
table(Clarity)

#Interval scaling
df[Clarity == "I1", "Clarity"] <- "1"
df[Clarity == "I2", "Clarity"] <- "2"
df[Clarity == "SI1", "Clarity"] <- "3"
df[Clarity == "SI2", "Clarity"] <- "4"
df[Clarity == "SI3", "Clarity"] <- "5"
df[Clarity == "VS1", "Clarity"] <- "6"
df[Clarity == "VS2", "Clarity"] <- "7"
df[Clarity == "VVS1", "Clarity"] <- "8"
df[Clarity == "VVS2", "Clarity"] <- "9"
df$Clarity <- as.numeric(df$Clarity)
table(df$Clarity)
```
```{r}
table(Polish)
df[Polish == "F", "Polish"] <- "Fair to Good"
df[Polish == "G", "Polish"] <- "Fair to Good"
df[Polish == "v", "Polish"] <- "Very Good to Ideal"
df[Polish == "V", "Polish"] <- "Very Good to Ideal"
df[Polish == "I", "Polish"] <- "Very Good to Ideal"
df[Polish == "X", "Polish"] <- "Very Good to Ideal"
table(df$Polish)
```
```{r}
table(Symmetry)
```



### Bootstrapping Model

### Using the coefficients given from the model you get the equation: Price = -288.74062 + 2686.4570(0.9) + 15.51392(1) - 465.49086(1) + 618.77332(1) + 489.84803(1) + 72.08555(1) - 15.23534(1) = 2844.49


```{r}
## Boot function
boot.fn <- function(data, index) {
  return(coef(lm(Price~Carat, data=data, subset=index)))
}
```
```{r}
set.seed(1)
boot.fn(df23, sample(240,240,replace=T))
```

```{r}
model <- glm(Price ~ Carat + Colour + Symmetry + Clarity + Cut + Polish + Certification)
summary(model)
```
```{r}
model <- glm(Price ~ Carat + Colour + Clarity )
summary(model)
```


